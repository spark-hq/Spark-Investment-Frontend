{"version":3,"file":"validation-D_gjHRZT.js","sources":["../../src/utils/validation.js"],"sourcesContent":["// ===================================\r\n// Form Validation Utilities\r\n// ===================================\r\n\r\n/**\r\n * Email validation\r\n * @param {string} email - Email to validate\r\n * @returns {Object} { isValid: boolean, error: string }\r\n */\r\nexport const validateEmail = (email) => {\r\n  if (!email || email.trim() === '') {\r\n    return { isValid: false, error: 'Email is required' };\r\n  }\r\n\r\n  // RFC 5322 compliant email regex\r\n  const emailRegex = /^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;\r\n\r\n  if (!emailRegex.test(email)) {\r\n    return { isValid: false, error: 'Please enter a valid email address' };\r\n  }\r\n\r\n  return { isValid: true, error: '' };\r\n};\r\n\r\n/**\r\n * Password validation\r\n * Requirements: minimum 8 characters, at least one uppercase, one lowercase, one number, one special character\r\n * @param {string} password - Password to validate\r\n * @returns {Object} { isValid: boolean, error: string, strength: string }\r\n */\r\nexport const validatePassword = (password) => {\r\n  if (!password || password.trim() === '') {\r\n    return { isValid: false, error: 'Password is required', strength: 'none' };\r\n  }\r\n\r\n  if (password.length < 8) {\r\n    return { isValid: false, error: 'Password must be at least 8 characters', strength: 'weak' };\r\n  }\r\n\r\n  const hasUppercase = /[A-Z]/.test(password);\r\n  const hasLowercase = /[a-z]/.test(password);\r\n  const hasNumber = /[0-9]/.test(password);\r\n  const hasSpecialChar = /[!@#$%^&*()_+\\-=\\[\\]{};':\"\\\\|,.<>\\/?]/.test(password);\r\n\r\n  const missingRequirements = [];\r\n\r\n  if (!hasUppercase) missingRequirements.push('one uppercase letter');\r\n  if (!hasLowercase) missingRequirements.push('one lowercase letter');\r\n  if (!hasNumber) missingRequirements.push('one number');\r\n  if (!hasSpecialChar) missingRequirements.push('one special character');\r\n\r\n  if (missingRequirements.length > 0) {\r\n    return {\r\n      isValid: false,\r\n      error: `Password must contain ${missingRequirements.join(', ')}`,\r\n      strength: 'weak',\r\n    };\r\n  }\r\n\r\n  // Calculate strength\r\n  let strength = 'medium';\r\n  if (password.length >= 12 && hasUppercase && hasLowercase && hasNumber && hasSpecialChar) {\r\n    strength = 'strong';\r\n  }\r\n\r\n  return { isValid: true, error: '', strength };\r\n};\r\n\r\n/**\r\n * Confirm password validation\r\n * @param {string} password - Original password\r\n * @param {string} confirmPassword - Confirmation password\r\n * @returns {Object} { isValid: boolean, error: string }\r\n */\r\nexport const validateConfirmPassword = (password, confirmPassword) => {\r\n  if (!confirmPassword || confirmPassword.trim() === '') {\r\n    return { isValid: false, error: 'Please confirm your password' };\r\n  }\r\n\r\n  if (password !== confirmPassword) {\r\n    return { isValid: false, error: 'Passwords do not match' };\r\n  }\r\n\r\n  return { isValid: true, error: '' };\r\n};\r\n\r\n/**\r\n * Name validation\r\n * @param {string} name - Name to validate\r\n * @returns {Object} { isValid: boolean, error: string }\r\n */\r\nexport const validateName = (name) => {\r\n  if (!name || name.trim() === '') {\r\n    return { isValid: false, error: 'Name is required' };\r\n  }\r\n\r\n  if (name.trim().length < 2) {\r\n    return { isValid: false, error: 'Name must be at least 2 characters' };\r\n  }\r\n\r\n  if (name.trim().length > 50) {\r\n    return { isValid: false, error: 'Name must be less than 50 characters' };\r\n  }\r\n\r\n  // Only allow letters, spaces, and common name characters\r\n  const nameRegex = /^[a-zA-Z\\s'-]+$/;\r\n  if (!nameRegex.test(name)) {\r\n    return { isValid: false, error: 'Name can only contain letters, spaces, hyphens, and apostrophes' };\r\n  }\r\n\r\n  return { isValid: true, error: '' };\r\n};\r\n\r\n/**\r\n * Phone validation (Indian format)\r\n * @param {string} phone - Phone number to validate\r\n * @returns {Object} { isValid: boolean, error: string }\r\n */\r\nexport const validatePhone = (phone) => {\r\n  if (!phone || phone.trim() === '') {\r\n    return { isValid: false, error: 'Phone number is required' };\r\n  }\r\n\r\n  // Remove spaces, hyphens, and other common separators\r\n  const cleanedPhone = phone.replace(/[\\s\\-()]/g, '');\r\n\r\n  // Indian phone number: 10 digits, optionally with +91 or 91 prefix\r\n  const phoneRegex = /^(\\+91|91)?[6-9]\\d{9}$/;\r\n\r\n  if (!phoneRegex.test(cleanedPhone)) {\r\n    return { isValid: false, error: 'Please enter a valid 10-digit Indian phone number' };\r\n  }\r\n\r\n  return { isValid: true, error: '' };\r\n};\r\n\r\n/**\r\n * Date of Birth validation\r\n * @param {string} dob - Date of birth (YYYY-MM-DD format)\r\n * @returns {Object} { isValid: boolean, error: string }\r\n */\r\nexport const validateDOB = (dob) => {\r\n  if (!dob || dob.trim() === '') {\r\n    return { isValid: false, error: 'Date of birth is required' };\r\n  }\r\n\r\n  const dobDate = new Date(dob);\r\n  const today = new Date();\r\n\r\n  // Check if valid date\r\n  if (isNaN(dobDate.getTime())) {\r\n    return { isValid: false, error: 'Please enter a valid date' };\r\n  }\r\n\r\n  // Check if date is not in future\r\n  if (dobDate > today) {\r\n    return { isValid: false, error: 'Date of birth cannot be in the future' };\r\n  }\r\n\r\n  // Calculate age\r\n  const age = Math.floor((today - dobDate) / (365.25 * 24 * 60 * 60 * 1000));\r\n\r\n  // Check minimum age (18 for trading/investing)\r\n  if (age < 18) {\r\n    return { isValid: false, error: 'You must be at least 18 years old to register' };\r\n  }\r\n\r\n  // Check maximum age (150 years)\r\n  if (age > 150) {\r\n    return { isValid: false, error: 'Please enter a valid date of birth' };\r\n  }\r\n\r\n  return { isValid: true, error: '' };\r\n};\r\n\r\n/**\r\n * OTP validation\r\n * @param {string} otp - OTP to validate\r\n * @returns {Object} { isValid: boolean, error: string }\r\n */\r\nexport const validateOTP = (otp) => {\r\n  if (!otp || otp.trim() === '') {\r\n    return { isValid: false, error: 'OTP is required' };\r\n  }\r\n\r\n  // OTP should be 6 digits\r\n  const otpRegex = /^\\d{6}$/;\r\n\r\n  if (!otpRegex.test(otp)) {\r\n    return { isValid: false, error: 'OTP must be a 6-digit number' };\r\n  }\r\n\r\n  return { isValid: true, error: '' };\r\n};\r\n\r\n/**\r\n * Generic required field validation\r\n * @param {string} value - Value to validate\r\n * @param {string} fieldName - Name of the field for error message\r\n * @returns {Object} { isValid: boolean, error: string }\r\n */\r\nexport const validateRequired = (value, fieldName = 'This field') => {\r\n  if (!value || value.toString().trim() === '') {\r\n    return { isValid: false, error: `${fieldName} is required` };\r\n  }\r\n\r\n  return { isValid: true, error: '' };\r\n};\r\n\r\n/**\r\n * Validate entire form\r\n * @param {Object} formData - Form data object\r\n * @param {Object} validationRules - Validation rules object\r\n * @returns {Object} { isValid: boolean, errors: Object }\r\n */\r\nexport const validateForm = (formData, validationRules) => {\r\n  const errors = {};\r\n  let isValid = true;\r\n\r\n  Object.keys(validationRules).forEach((fieldName) => {\r\n    const validationFn = validationRules[fieldName];\r\n    const value = formData[fieldName];\r\n\r\n    const result = validationFn(value);\r\n\r\n    if (!result.isValid) {\r\n      errors[fieldName] = result.error;\r\n      isValid = false;\r\n    }\r\n  });\r\n\r\n  return { isValid, errors };\r\n};\r\n\r\n/**\r\n * Get password strength indicator\r\n * @param {string} password - Password to check\r\n * @returns {Object} { strength: string, color: string, percentage: number }\r\n */\r\nexport const getPasswordStrength = (password) => {\r\n  if (!password) {\r\n    return { strength: 'None', color: 'gray', percentage: 0 };\r\n  }\r\n\r\n  const validation = validatePassword(password);\r\n\r\n  const strengthMap = {\r\n    weak: { strength: 'Weak', color: 'red', percentage: 33 },\r\n    medium: { strength: 'Medium', color: 'yellow', percentage: 66 },\r\n    strong: { strength: 'Strong', color: 'green', percentage: 100 },\r\n  };\r\n\r\n  return strengthMap[validation.strength] || strengthMap.weak;\r\n};\r\n"],"names":["validateEmail","email","validatePassword","password","hasUppercase","hasLowercase","hasNumber","hasSpecialChar","missingRequirements","strength","validateConfirmPassword","confirmPassword","validateName","name","validatePhone","phone","cleanedPhone","validateDOB","dob","dobDate","today","age","validateOTP","otp","validateRequired","value","fieldName","getPasswordStrength","validation","strengthMap"],"mappings":"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"}